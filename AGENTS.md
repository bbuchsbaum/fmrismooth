# Repository Guidelines

## Project Structure & Module Organization
- R source: `R/` (exported APIs like `fmrismooth_default()`, utilities, pipelines).
- C++/Rcpp code: `src/` (filters and denoisers; compiled via Rcpp). Do not edit generated `RcppExports.cpp` manually.
- Tests: `tests/testthat/` with `test-*.R` files; harness in `tests/testthat.R`.
- Package metadata: `DESCRIPTION`, `NAMESPACE` (generated by roxygen2; do not hand‑edit).

## Build, Test, and Development Commands
- Install dev deps: `R -q -e "install.packages(c('devtools','testthat','RcppArmadillo'))"`.
- Run tests: `R -q -e "devtools::test()"` (uses testthat v3).
- Build tarball: `R CMD build .` → e.g., `fmrismooth_0.1.0.tar.gz`.
- Check package: `R CMD check fmrismooth_0.1.0.tar.gz` (runs R CMD check + tests).
- Iterate locally: `R -q -e "devtools::load_all(); fmrismooth::fmrismooth_default(array(rnorm(10*10*10*5), c(10,10,10,5)))"`.
- Regenerate interfaces: `R -q -e "Rcpp::compileAttributes(); devtools::document()"`.

## Coding Style & Naming Conventions
- R: 2‑space indents, no tabs; snake_case for functions (`st_guided_filter3d`, `recommend_params`).
- C++: prefer snake_case for functions/vars to match R API; C++11 (`CXX_STD = CXX11`).
- Documentation: roxygen2 comments above R functions; never edit `NAMESPACE` directly.

## Testing Guidelines
- Framework: testthat (Edition 3). Place tests in `tests/testthat/` as `test-<topic>.R`.
- Write focused, deterministic tests; prefer synthetic arrays for speed.
- Run locally with `devtools::test()`; full validation with `R CMD check`.

## Commit & Pull Request Guidelines
- Commits: imperative mood, concise scope prefix (e.g., `filters: fix sigma scaling`).
- PRs: include summary, motivation, and validation (tests or example code/outputs). Link issues when applicable.
- Required: tests for new features/bugfixes, no changes to generated files without running regenerate commands above.

## Security & Configuration Tips
- Compiled code links BLAS/LAPACK; ensure toolchain installed (e.g., Xcode CLT on macOS, build‑essentials on Linux).
- Large arrays can be memory‑intensive; prefer small dims in tests and examples.
