% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mp_pca4d.R
\name{mp_pca4d}
\alias{mp_pca4d}
\title{MP-PCA denoising (local patches Ã— time) for 4D fMRI}
\usage{
mp_pca4d(
  vec,
  patch = c(5L, 5L, 5L),
  tw = 32L,
  stride = c(3L, 3L, 3L, 8L),
  sigma_mode = c("patch", "global", "fixed"),
  sigma_value = NULL,
  mask = NULL
)
}
\arguments{
\item{vec}{4D fMRI array or `NeuroVec`.}

\item{patch}{Integer length-3 patch size (voxels).}

\item{tw}{Temporal window size (frames).}

\item{stride}{Integer length-4 stride for x,y,z,t.}

\item{sigma_mode}{Noise mode: 'patch' (estimate per-patch), 'global' (one value), or 'fixed'.}

\item{sigma_value}{Noise sigma when `sigma_mode='fixed'`.}

\item{mask}{Optional 3D logical/0-1 mask.}
}
\value{
Denoised 4D data, wrapped like `vec` when possible.
}
\description{
Performs local PCA denoising in overlapping 3D spatial patches across a
temporal window.
}
