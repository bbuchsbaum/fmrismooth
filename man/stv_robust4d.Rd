% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/robust.R
\name{stv_robust4d}
\alias{stv_robust4d}
\title{Robust space-time smoothing (Huber or Tukey) + anisotropic TV}
\usage{
stv_robust4d(
  vec,
  lambda_s = 0.8,
  lambda_t = 0.2,
  loss = c("huber", "tukey"),
  delta = NULL,
  cthresh = NULL,
  alpha = 1,
  temporal_weights = NULL,
  motion_params = NULL,
  sigma_m = 0.5,
  iters = 35L,
  mask = NULL,
  tau = NULL,
  sigma = NULL,
  theta = 1
)
}
\arguments{
\item{vec}{4D fMRI array or `NeuroVec`.}

\item{lambda_s}{Spatial TV weight.}

\item{lambda_t}{Temporal TV weight.}

\item{loss}{Robust loss: `'huber'` or `'tukey'`.}

\item{delta}{Huber threshold; if `NULL`, derived from noise.}

\item{cthresh}{Tukey threshold; if `NULL`, derived from noise.}

\item{alpha}{Tukey shape parameter.}

\item{temporal_weights}{Optional length-(T or T-1) temporal edge weights.}

\item{motion_params}{Optional motion regressors to derive temporal weights.}

\item{sigma_m}{Motion weight scale.}

\item{iters}{Iterations for the robust solver.}

\item{mask}{Optional 3D logical/0-1 mask.}

\item{tau}{Algorithm primal step size; if `NULL`, a sensible default is used.}

\item{sigma}{Algorithm dual step size; if `NULL`, a sensible default is used.}

\item{theta}{Over-relaxation parameter.}
}
\value{
Smoothed 4D data, wrapped like `vec` when possible.
}
\description{
Applies a robust data term (Huber or Tukey) with spatial/temporal TV priors,
optionally with motion-aware temporal weights.
}
